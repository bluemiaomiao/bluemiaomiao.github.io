<!doctype html><html lang=zh><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Halo的主页 - 学习 kubeadm 源码</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css><link rel=stylesheet href=../../css/halo.css><link rel=stylesheet href=../../css/github-markdown.css><link rel=stylesheet href=../../css/github-markdown-light.css><link rel=stylesheet href=../../css/markdown-rewrite.css><link rel="shortcut icon" href=favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"><style>body{display:flex;flex-direction:column;align-items:center}a{color:#5e5e5e;text-decoration:none}</style></head><body><div id=top style=width:0;height:0></div><div class=top-button><a href=#top style=text-decoration:none>Top</a></div><div id=toc>目<br>录</div><div id=header><div style=width:100%;display:flex;align-items:center;height:100%><div class=disable-select style=display:flex;justify-content:flex-end;font-size:14pt;font-weight:700;color:#555><div style=margin-right:35px></div><div><a style=color:#555;text-decoration:none href=../../>&lt;Halo的主页/></a></div></div><div style=flex:1;display:flex;justify-content:flex-end;font-size:14pt;font-weight:700;color:#555><div style=margin-right:45px><a href=https://www.wecomz.com style=color:#555;text-decoration:none>WecomZ</a></div><div style=margin-right:45px><a href=../../article style=color:#555;text-decoration:none>文章</a></div><div style=margin-right:45px><a href=../../video style=color:#555;text-decoration:none>视频</a></div><div style=margin-right:45px><a href=../../about style=color:#555;text-decoration:none>关于</a></div><div style=margin-left:35px></div></div></div></div><div id=article-content><div class=content-header><div>《学习 kubeadm 源码》</div><div style=font-size:10pt;height:100%;display:flex;align-items:flex-end;padding-bottom:12pt;color:#5e5e5e;font-weight:lighter>在2022/02/15 19:45:08更新，大约共100字。</div></div><div class=content-desc><div style=font-size:50pt;font-weight:700;color:#eee;padding-right:15px>“</div><div style=line-height:50pt;color:#9b9b9b>[迁移中]通过研究 kubeadm 源代码学习如何构建命令行程序。</div><div style=font-size:50pt;font-weight:700;color:#eee;padding-left:15px>”</div></div><div class="content-area markdown-body"><h1 id=背景与问题>背景与问题</h1><p>Kubeadm是芬兰的一个高中生在2015年的夏季所开发的，它本人也是云原生的爱好者，在CNCF社区处于领导职位。在Kubeadm没有发布之前，Kubernetes社区面临的问题是部署困难，且没有统一的、官方的部署方式。</p><p>愿意尝试使用Kubernetes的人必须忍受繁琐的步骤并且需要弄清楚整个Kubernetes的架构细节，例如拷贝二进制、分发证书、设置命令行启动参数等。随后Kubernetes社区提供了一个安装脚本，叫做kube-up，但是依旧是用于测试的，很快开源社区便出现了使用Chef、Puppet、Ansible等自动化部署工具构建的部署方式。但是这些部署方式都不是完美的并且也不是官方所推荐的。</p><p>社区开始在外界寻找灵感，Docker Swarm的出现刺激了社区的开发人员，Kubeadm就这样诞生了。Kubernetes整个软件的设计是采用模块化的，高内聚低耦合，支持各种灵活的部署方式，确定Kubeadm的设计目标后，由Kubernetes SIG负责设计的Kubeadm开始并入Kubernetes源代码作为官方所推荐的生产环境下的部署工具。</p><p>使用Kubeadm并不需要深入了解Kubernetes的各种细节，但是通过本文深入探索Kubeadm的设计与实现，你可以还原整个Kubernetes集群部署所做的细节。</p><h1 id=搭建源代码分析环境>搭建源代码分析环境</h1><p>Kubernetes的源代码由于实现的缘故，目前有些地方仅支持类UNIX系统，我们所需的工具如下：</p><ul><li>Goland：JetBrains出品的Goland是主流的付费Golang IDE，具有强大的静态代码分析与推导能力，开源软件作者和教育工作者可以获得免费的许可。如果你不愿意为此付费，Mircosoft Visual Studio Code也是一个比较不错的编辑器，基于Electron开发，但是编辑器终究还是编辑器。</li><li>Vim：跨平台的文本编辑器，我们需要在Linux服务器上安装，以方便随时查看代码。</li><li>Go 1.17.x：Kubernetes版本与Golang的版本是绑定关系，本文采用Kubernetes 1.22.x版本，因此需要安装Go 1.17.x</li><li>Open SSH Server：我们Mac/Windows上的Kubernetes源代码编辑完成以后需要通过Goland内置的SFTP上传到Linux服务器。</li><li>Git：Kubernetes源代码使用分布式版本控制系统Git来管理。</li><li>Ubuntu 21.04：Linux发行版，你可以选择自己喜欢的Linux发行版。</li><li>GCC、G++环境：Kubernetes源代码中不仅Go代码，还有C/C++代码和汇编ASM代码，因此你需要为Linux服务器部署C/C++环境。如果你想在本地编译Kubernetes源代码，那么你需要安装Vistual Studio或者XCode。</li></ul><p>具体的方式如下图所示：</p><p><img src=../../article/kubernetes-kubeadm/640.png alt></p></div></div><footer id=footer><div class=footer-inner><div><div style=font-weight:700;margin-bottom:15px>发布地址</div><div><a href=https://halo.wecomz.com>Halo的主页自动加速体验（推荐）</a></div><div><a href=https://bluemiaomiao.gitee.io>Halo的主页中国境内镜像</a></div><div><a href=https://bluemiaomiao.github.io>Halo的主页中国境外镜像</a></div></div><div><div style=font-weight:700;margin-bottom:15px>友情链接</div><div><a href=https://debuginn.cn>DebugInn</a></div><div><a href=https://blog.csdn.net/qq_43442524>普通Gopher</a></div></div><div><div style=font-weight:700;margin-bottom:15px>开源软件</div><div><a href=https://bluemiaomiao.github.io/libsshd/>OpenSSH Configuration Library</a></div><div><a href=https://bluemiaomiao.github.io/fastdfs-spring-boot-starter/>FastDFS SpringBoot Starter</a></div><div><a href=https://bluemiaomiao.github.io/librocm-smi-gobinding/>AMD ROCm SMI for Golang</a></div><div><a href=https://bluemiaomiao.github.io/libnvml-smi-gobinding>NVIDIA NVML SMI for Golang</a></div><div><a href=https://www.wecomz.com/software/zgraphics>zGraphics(Prometheus GPU Exporter)</a></div><div><a href=https://www.wecomz.com/software/ztrader>zTrader Framework</a></div></div><div><div style=font-weight:700;margin-bottom:15px>其他</div><div><a href=https://values.wecomz.com>WecomZ 价值观</a></div></div></div><div class=icp><div style=min-height:13px;min-width:13px;background-image:url(/image/beian.png);background-repeat:no-repeat;background-size:contain;margin-right:5px></div><div><a href=https://beian.miit.gov.cn target=_blank>鲁ICP备2023019133号</a></div></div></footer></body><script src=../../js/halo.js type=text/javascript></script></html>